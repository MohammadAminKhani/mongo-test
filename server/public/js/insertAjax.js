// send a form and show its data!
// to have ...
// 2 APIs in one page - at the same time
// use Ajax - to send and receive data - behind the scene

$(function() {

// find1 ajax
  $.getJSON('api', updateShowList)

// insert ajax
$('#insertform').submit(function(e){
  e.preventDefault()

  $.post('api',{
    tourPrice: $('#tourPrice').val(),
    tourDescription: $('#tourDescription').val()
  }, updateShowList)

})

// delete ajax
$('.showlist').on('click',function(e){
  // at 1st get element which exists phisically
  // then communicate with the special icon of special item
  // (items generated by for loop in js)
  // how communicate? with e.target.className
  if(e.target.className == 'delButton'){
    $.ajax({
      url: 'api/' + e.target.id,
      type: 'DELETE',
      success: updateShowList
    }) }
})

// find2 ajax
  function updateShowList(data) {
   var output = ''

   $.each(data,function(key, item) {
        output += `
        <div>
        <h1 style='color:gray'>NO.${key}</h1>
        <button style='background-color:red' class='delButton'
        id='${item._id}'>Delete</button>

        <p>_id (mongodb): ${item._id}</p>
        <p>tourPrice: ${item.tourPrice}</p>
        <p>Description: </p>
        <p style='color:lightgray'>${item.tourDescription}</p>
        </div><br>`
   })

   $('.showlist').html(output)
  }


})
